name: Daily Greek Words

on:
  schedule:
    # Runs every day at 20:00 UTC
    - cron: '0 0 * * *'
  workflow_dispatch: # allows manual run

jobs:
  daily_greek:
    runs-on: ubuntu-24.04

    permissions:
      contents: write # needed to push changes

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Generate daily words
        run: |
          python3 - << 'EOF'
          import json, random
          with open("greek_vocab.json", encoding="utf-8") as f:
              data = json.load(f)
          words = data["words"]
          sample = random.sample(words, min(5, len(words)))
          with open("daily_greek.json", "w", encoding="utf-8") as f:
              json.dump({"words": sample}, f, ensure_ascii=False, indent=2)
          EOF

      - name: Check for changes
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add daily_greek.json
          # Only commit if there are changes
          if ! git diff --cached --quiet; then
            git commit -m "Update daily 5 Greek words"
            git push origin HEAD:main
          else
            echo "No changes to commit"
          fi
